<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>第 6 章 Spring MVC</title><link rel="stylesheet" type="text/css" href="../..//docbook.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="../../index.html" title="Netkiller Java 手札" /><link rel="up" href="../index.html" title="部分 I. Spring Framework" /><link rel="prev" href="../boot/faq.html" title="5.34. FAQ" /><link rel="next" href="RestController.html" title="6.2. @RestController" /></head><body><a xmlns="" href="//www.netkiller.cn/">Home</a> |
		<a xmlns="" href="//netkiller.github.io/">简体中文</a> |
	    <a xmlns="" href="http://netkiller.sourceforge.net/">繁体中文</a> |
	    <a xmlns="" href="/journal/index.html">杂文</a> |
	    <a xmlns="" href="//www.netkiller.cn/home/donations.html">打赏(Donations)</a> |
	    <a xmlns="" href="http://netkiller-github-com.iteye.com/">ITEYE 博客</a> |
	    <a xmlns="" href="http://my.oschina.net/neochen/">OSChina 博客</a> |
	    <a xmlns="" href="https://www.facebook.com/bg7nyt">Facebook</a> |
	    <a xmlns="" href="http://cn.linkedin.com/in/netkiller/">Linkedin</a> |
	    <a xmlns="" href="https://zhuanlan.zhihu.com/netkiller">知乎专栏</a> |
	    <a xmlns="" href="/search.html">Search</a> |
		<a xmlns="" href="mailto:netkiller@msn.com">Email</a><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第 6 章 Spring MVC</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="../boot/faq.html">上一页</a> </td><th width="60%" align="center">部分 I. Spring Framework</th><td width="20%" align="right"> <a accesskey="n" href="RestController.html">下一页</a></td></tr></table><hr /></div><table xmlns=""><tr><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=watch&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=fork&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;type=follow&amp;count=true&amp;size=large" height="30" width="240" frameborder="0" scrolling="0" style="width:240px; height: 30px;" allowTransparency="true"></iframe></td></tr></table><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="index"></a>第 6 章 Spring MVC</h2></div></div></div><div class="toc"><p><strong>目录</strong></p><dl class="toc"><dt><span class="section"><a href="index.html#controller">6.1. @Controller</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#@RequestMapping">6.1.1. @RequestMapping</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idp224">6.1.1.1. @RequestMapping("/")</a></span></dt><dt><span class="section"><a href="index.html#idp225">6.1.1.2. 映射多个URL</a></span></dt><dt><span class="section"><a href="index.html#idp226">6.1.1.3. headers</a></span></dt></dl></dd><dt><span class="section"><a href="index.html#@ResponseBody">6.1.2. @ResponseBody</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idp227">6.1.2.1. 直接返回HTML</a></span></dt></dl></dd><dt><span class="section"><a href="index.html#@PathVariable">6.1.3. RequestMapping with Path Variables - @PathVariable</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idp228">6.1.3.1. URL 参数传递</a></span></dt><dt><span class="section"><a href="index.html#idp229">6.1.3.2. URL 传递 Date 类型</a></span></dt><dt><span class="section"><a href="index.html#idp230">6.1.3.3. 处理特殊字符</a></span></dt><dt><span class="section"><a href="index.html#idp231">6.1.3.4. @PathVariable 注意事项</a></span></dt></dl></dd><dt><span class="section"><a href="index.html#@RequestParam">6.1.4. RequestMapping with Request Parameters - @RequestParam</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idp232">6.1.4.1. HTTP GET</a></span></dt><dt><span class="section"><a href="index.html#idp233">6.1.4.2. HTTP POST</a></span></dt><dt><span class="section"><a href="index.html#idp234">6.1.4.3. @RequestParam 传递特殊字符串</a></span></dt><dt><span class="section"><a href="index.html#idp235">6.1.4.4. 传递日期参数</a></span></dt></dl></dd><dt><span class="section"><a href="index.html#ModelAttribute">6.1.5. @ModelAttribute</a></span></dt><dt><span class="section"><a href="index.html#ModelAndView">6.1.6. ModelAndView</a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idp236">6.1.6.1. 变量传递</a></span></dt><dt><span class="section"><a href="index.html#idp237">6.1.6.2. ModelMap 传递多个变量</a></span></dt><dt><span class="section"><a href="index.html#idp238">6.1.6.3. redirect</a></span></dt><dt><span class="section"><a href="index.html#idp239">6.1.6.4. ArrayList</a></span></dt><dt><span class="section"><a href="index.html#idp240">6.1.6.5. HashMap</a></span></dt><dt><span class="section"><a href="index.html#idp241">6.1.6.6. 传递对象</a></span></dt><dt><span class="section"><a href="index.html#idp242">6.1.6.7. </a></span></dt></dl></dd><dt><span class="section"><a href="index.html#@Scheduled">6.1.7. @Scheduled</a></span></dt><dt><span class="section"><a href="index.html#@CrossOrigin">6.1.8. @CrossOrigin</a></span></dt><dt><span class="section"><a href="index.html#@SessionAttributes">6.1.9. @SessionAttributes</a></span></dt><dt><span class="section"><a href="index.html#http">6.1.10. HttpServletRequest / HttpServletResponse </a></span></dt><dd><dl><dt><span class="section"><a href="index.html#idp243">6.1.10.1. 用于方法参数</a></span></dt><dt><span class="section"><a href="index.html#idp244">6.1.10.2. 注入方式</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="RestController.html">6.2. @RestController</a></span></dt><dd><dl><dt><span class="section"><a href="RestController.html#idp245">6.2.1. 返回实体</a></span></dt><dt><span class="section"><a href="RestController.html#idp246">6.2.2. JSON</a></span></dt><dt><span class="section"><a href="RestController.html#idp247">6.2.3. XML</a></span></dt><dt><span class="section"><a href="RestController.html#idp248">6.2.4. 兼容传统 json 接口</a></span></dt><dt><span class="section"><a href="RestController.html#PageableDefault">6.2.5. @PageableDefault 分页</a></span></dt></dl></dd><dt><span class="section"><a href="view.html">6.3. View</a></span></dt><dd><dl><dt><span class="section"><a href="view.html#tag">6.3.1. Using Spring’s form tag library</a></span></dt><dd><dl><dt><span class="section"><a href="view.html#idp252">6.3.1.1. css</a></span></dt><dt><span class="section"><a href="view.html#idp253">6.3.1.2. cssClass</a></span></dt></dl></dd><dt><span class="section"><a href="view.html#thymeleaf">6.3.2. Thymeleaf</a></span></dt><dd><dl><dt><span class="section"><a href="view.html#idp254">6.3.2.1. Maven pom.xml</a></span></dt><dt><span class="section"><a href="view.html#idp255">6.3.2.2. Spring 配置</a></span></dt><dt><span class="section"><a href="view.html#idp256">6.3.2.3. controller</a></span></dt><dt><span class="section"><a href="view.html#idp257">6.3.2.4. HTML5 Template</a></span></dt></dl></dd><dt><span class="section"><a href="view.html#freemarker">6.3.3. FreeMarker</a></span></dt></dl></dd><dt><span class="section"><a href="properties.html">6.4. Properties</a></span></dt><dd><dl><dt><span class="section"><a href="properties.html#idp258">6.4.1. 载入*.properties文件</a></span></dt><dt><span class="section"><a href="properties.html#idp259">6.4.2. @Value 注解</a></span></dt><dt><span class="section"><a href="properties.html#idp260">6.4.3. @PropertySource 注解</a></span></dt></dl></dd><dt><span class="section"><a href="faq.html">6.5. FAQ</a></span></dt><dd><dl><dt><span class="section"><a href="faq.html#idp261">6.5.1. o.s.web.servlet.PageNotFound</a></span></dt><dt><span class="section"><a href="faq.html#idp262">6.5.2. HTTP Status 500 - Handler processing failed; nested exception
				is java.lang.NoClassDefFoundError:
				javax/servlet/jsp/jstl/core/Config</a></span></dt><dt><span class="section"><a href="faq.html#idp263">6.5.3. 同时使用 Thymeleaf 与 JSP </a></span></dt><dt><span class="section"><a href="faq.html#idp264">6.5.4. 排除静态内容</a></span></dt><dt><span class="section"><a href="faq.html#idp265">6.5.5. HTTP Status 406</a></span></dt></dl></dd></dl></div>
	
	<p>Spring MVC 有两种启动模式，一种是传统Tomcat，需要配置很多XML文件。另一种方式是采用 Spring Boot 需要些一个Java程序，不需要写xml文件，这个程序会帮助你处理启动所需的一切，并且采用嵌入方式启动 Tomcat 或者 Jetty.</p>
	<p>两种方式各有优缺点，Tomcat 方式配置繁琐，但是可以使用虚拟机，同一个IP地址使用不同域名访问，出现不同的内容。而Spring Boot一个应用一个容器一个端口，比不得不通过端口来区分应用。</p>
	
<div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="controller"></a>6.1. @Controller</h2></div></div></div>
	
	<pre class="programlisting">
package cn.netkiller.controller;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.servlet.ModelAndView;

@Controller
public class Welcome {

	@RequestMapping("/welcome")
	public ModelAndView helloWorld() {

		String message = "Helloworld!!!";
		return new ModelAndView("welcome", "message", message);
	}
}
	</pre>

	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="@RequestMapping"></a>6.1.1. @RequestMapping</h3></div></div></div>
		
		<pre class="programlisting">
@RequestMapping("/welcome")
		</pre>
		<pre class="programlisting">
@RequestMapping(value = "/list", method = RequestMethod.GET)
		</pre>
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp224"></a>6.1.1.1. @RequestMapping("/")</h4></div></div></div>
			
			<pre class="programlisting">
			
package com.cf88.controller;

import org.springframework.stereotype.Controller;
import org.springframework.ui.ModelMap;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;

@Controller
@RequestMapping("/")
public class HelloController {

	@RequestMapping(value = "/{name}", method = RequestMethod.GET)
	public String getMovie(@PathVariable String name, ModelMap model) {
		model.addAttribute("name", name);
		return "hello";
	}

}		
			
			</pre>
		</div>		
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp225"></a>6.1.1.2. 映射多个URL</h4></div></div></div>
			
			<pre class="programlisting">
@RequestMapping({ "/news/zh-cn", "/news/zh-tw" })
@ResponseBody
public String getNewsByPath() {
    return "Hello";
}
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp226"></a>6.1.1.3. headers</h4></div></div></div>
			
			<pre class="programlisting">
			
@RequestMapping(value = "/news/json", method = GET, headers = "Accept=application/json")
@ResponseBody
public String getFoosAsJsonFromBrowser() {
    return "{...}";
}
			
			</pre>
			<pre class="screen">
curl -H "Accept:application/json,text/html" http://localhost:8080/spring/news/json.html
			</pre>
		</div>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="@ResponseBody"></a>6.1.2. @ResponseBody</h3></div></div></div>
		
		<pre class="programlisting">
import org.springframework.web.bind.annotation.ResponseBody;
		</pre>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp227"></a>6.1.2.1. 直接返回HTML</h4></div></div></div>
			
			<pre class="programlisting">
			
package cn.netkiller.controller;

import org.springframework.stereotype.Controller;
import org.springframework.ui.ModelMap;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.servlet.ModelAndView;

@Controller
public class Pathinfo {

	@RequestMapping(value = "/news/shenzhen/{numericId:[\\d]+}")
	@ResponseBody
	public String getNewsWithPathVariable(@PathVariable final long numericId) {
		return "Get a specific Bar with id=" + numericId;
	}

}

			
			</pre>
		</div>
	</div>
	
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="@PathVariable"></a>6.1.3. RequestMapping with Path Variables - @PathVariable</h3></div></div></div>
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp228"></a>6.1.3.1. URL 参数传递</h4></div></div></div>
			
			<p>需求，我们需要通过URL传递参数，所传递的值是分类ID与文章ID，例如 /news/1.html, /news/1/1.html。</p>
			<pre class="programlisting">
			
package cn.netkiller.controller;

import org.springframework.stereotype.Controller;
import org.springframework.ui.ModelMap;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.servlet.ModelAndView;

@Controller
public class Pathinfo {
	@RequestMapping("/pathinfo/{id}")
	public ModelAndView urlTestId(@PathVariable String id) {

		return new ModelAndView("pathinfo/param", "id", id);
	}

	@RequestMapping("/pathinfo/{cid}/{id}")
	public ModelAndView urlTestId(@PathVariable String cid, @PathVariable String id) {

		ModelMap model = new ModelMap();

		model.addAttribute("cid", cid);
		model.addAttribute("id", id);

		return new ModelAndView("pathinfo/param", model);
	}
}
			
			</pre>
			<p>jsp测试文件</p>
			<pre class="programlisting">
			
&lt;%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
&lt;title&gt;Insert title here&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
${ cid } &lt;br&gt;
${ id } &lt;br&gt;
&lt;/body&gt;
&lt;/html&gt;
			
			</pre>

		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp229"></a>6.1.3.2. URL 传递 Date 类型</h4></div></div></div>
			
			<p>http://localhost:7000/history/2016-09-28%2000:00:00/</p>
			<pre class="programlisting">
			
	@RequestMapping("/history/{datetime}")
	public String history(@PathVariable @DateTimeFormat(pattern="yyyy-MM-dd HH:mm:ss") Date datetime) throws Exception {

		System.out.println(datetime)

		return null;
	}			
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp230"></a>6.1.3.3. 处理特殊字符</h4></div></div></div>
			
			<p>http://www.netkiller.cn/release/1.0.1</p>
			<pre class="programlisting">
@RequestMapping(value = "/release/{version:[a-zA-Z0-9\\.]+}", method = RequestMethod.GET)  
public @ResponseBody  
String release(@PathVariable String version) {  
    log.debug("version: ", version);  
    return version;  
}
			</pre>
			<p>http://www.netkiller.cn/release/1.0.1/other</p>
			<pre class="programlisting">
@RequestMapping(value="/release/{version:.+}",method=RequestMethod.GET)
public void download(HttpSession session,@PathVariable("version")String version){
	return version;
}
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp231"></a>6.1.3.4. @PathVariable 注意事项</h4></div></div></div>
			
			<p>@PathVariable 参数传统需要注意，参数中不能携带 “/”,斜杠会被视为目录。</p>
			<pre class="programlisting">
			
	@RequestMapping("/PathVariable/{code}.html")
	@ResponseBody
	public String urlTestId(@PathVariable String code) {
		return code;
	}
			
			</pre>
		</div>
	</div>

	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="@RequestParam"></a>6.1.4. RequestMapping with Request Parameters - @RequestParam</h3></div></div></div>
		
		<pre class="programlisting">
import org.springframework.web.bind.annotation.RequestParam;
		</pre>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp232"></a>6.1.4.1. HTTP GET</h4></div></div></div>
			
			<pre class="programlisting">
			
	@RequestMapping("/request/param")
	@ResponseBody
	public String getBarBySimplePathWithRequestParam(@RequestParam("id") long id) {
	    return "Get a specific Bar with id=" + id;
	}
			
			</pre>
			<p></p>
			<pre class="screen">
http://localhost:8080/Spring/request/param.html?id=100
			</pre>
		</div>

		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp233"></a>6.1.4.2. HTTP POST</h4></div></div></div>
			
			<pre class="programlisting">
			
package cn.netkiller.controller;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpSession;

import org.springframework.stereotype.Controller;
import org.springframework.ui.ModelMap;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.ResponseBody;
import org.springframework.web.servlet.ModelAndView;

@Controller
public class Http {

	@RequestMapping("/http/form")
	public ModelAndView createCustomer(){
		ModelMap model = new ModelMap();

		model.addAttribute("email", "netkiller@msn.com");
		model.addAttribute("phone", "13113668890");

	    return new ModelAndView("http/form", model);
	}

	@RequestMapping(value= "/http/post", method = RequestMethod.POST)
	public ModelAndView saveCustomer(HttpServletRequest request,
	        @RequestParam(value="Email", required=false) String email,
	        @RequestParam(value="Password", required=false) String password,
	        @RequestParam(value="Phone", required=false) String phone){

		ModelMap model = new ModelMap();

		model.addAttribute("email", email);
		model.addAttribute("password", password);
		model.addAttribute("phone", phone);

	    return new ModelAndView("http/post", model);
	}

}
			
			</pre>
			<p>http/form.jsp</p>
			<pre class="programlisting">
			
&lt;%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
&lt;title&gt;Insert title here&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

	&lt;form method="POST"
		action="http://localhost:8080/Spring/http/post.html" id="Register"
		name="Register"&gt;
		Email: &lt;input class="register" type="text" id="Email" name="Email" value="${email}" /&gt; &lt;br /&gt;
		Password： &lt;input class="register" type="password" id="Password" name="Password" value="" /&gt;&lt;br /&gt;
		Phone： &lt;input class="register" type="text" id="Phone" name="Phone" value="${phone}" /&gt; &lt;br /&gt;
		&lt;input type="submit" id="btnRegister" name="btnRegister" value="Register" style="cursor: pointer" /&gt;
	&lt;/form&gt;

&lt;/body&gt;
&lt;/html&gt;
			
			</pre>
			<p>http/post.jsp</p>
			<pre class="programlisting">
			
&lt;%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8"&gt;
&lt;title&gt;Insert title here&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
	${email}&lt;br&gt;
	${password}	&lt;br&gt;
	${phone} &lt;br&gt;
&lt;/body&gt;
&lt;/html&gt;
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp234"></a>6.1.4.3. @RequestParam 传递特殊字符串</h4></div></div></div>
			
			<p>URL 中 “+” 有特殊意义，表示空格。</p>
			<p>如果 @RequestParam 传递参数含有空格可以这样处理。</p>
			<pre class="programlisting">
			
	@RequestMapping("/RequestParam")
	@ResponseBody
	public String query(@RequestParam("code") String code) {

		return code.replace(" ", "+");

	}
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp235"></a>6.1.4.4. 传递日期参数</h4></div></div></div>
			
			<pre class="programlisting">
			
	@RequestMapping("/range")
	public ModelAndView range(@RequestParam("beginDate") @DateTimeFormat(pattern = "yyyy-MM-dd") Date beginDate, @RequestParam("endDate") @DateTimeFormat(pattern = "yyyy-MM-dd") Date endDate) {
		log.info("===== Begin ===== {}", beginDate);

		// 你的逻辑

		log.info("===== End ===== {}", endDate);
		return new ModelAndView("activity/index", "message", "操作成功");
	}
			
			</pre>
		</div>
	</div>
	
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="ModelAttribute"></a>6.1.5. @ModelAttribute</h3></div></div></div>
		
		<p>@ModelAttribute 处理 HTML FORM POST 提交</p>
		<pre class="programlisting">
		
package cn.netkiller.pojo;

import java.util.List;

public class Deploy {

	private String group;
	private String envionment;
	private String project;
	private List&lt;String&gt; arguments;
	public Deploy() {
		// TODO Auto-generated constructor stub
	}
	// Getters &amp; Setters
}
		
		</pre>
		<pre class="programlisting">
		
	@RequestMapping(value="/deploy/post",  method = RequestMethod.POST)
	public ModelAndView post(@ModelAttribute("deploy")Deploy deploy, BindingResult result) {
		if (result.hasErrors()) {
			System.out.println(result.toString());
        }
		System.out.println(deploy.toString());
		return new ModelAndView("output").addObject("output", deploy.toString());
	}		
		
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="ModelAndView"></a>6.1.6. ModelAndView</h3></div></div></div>
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp236"></a>6.1.6.1. 变量传递</h4></div></div></div>
			
			<pre class="programlisting">
	@RequestMapping("/testString")
	public ModelAndView helloWorld() {
		String message = "Helloworld!!!";
		return new ModelAndView("welcome", "message", message);
	}
			</pre>

			<pre class="programlisting">
	public ModelAndView handleRequestInternal() {

		ModelAndView mav = new ModelAndView("test");// 实例化一个VIew的ModelAndView实例
		mav.addObject("variable", "Hello World!");// 添加一个带名的model对象
		return mav;
	}
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp237"></a>6.1.6.2. ModelMap 传递多个变量</h4></div></div></div>
			
			<p>传递多个字符串</p>
			<pre class="programlisting">
	@RequestMapping("/testModelMap")
	public ModelAndView testModelMap() {
		ModelMap model = new ModelMap();

		model.addAttribute("username", "Neo");
		model.addAttribute("password", "Netkiller");

		return new ModelAndView("test/modelmap", model);
	}
			</pre>
			<p>推荐使用ModelMap</p>
			<pre class="programlisting">
			
	@RequestMapping("/testMapString")
	public ModelAndView testMapString() {

		Map&lt;String,String&gt; data = new HashMap&lt;String,String&gt;();
		data.put("username","Neo");
		data.put("password","Netkiller");
	    return new ModelAndView("test/modelmap",data);

	}
			
			</pre>
			<pre class="programlisting">
			
&lt;%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"&gt;
&lt;title&gt;Insert title here&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
${username}&lt;br&gt;
${password}&lt;br&gt;
&lt;/body&gt;
&lt;/html&gt;
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp238"></a>6.1.6.3. redirect</h4></div></div></div>
			
			<pre class="programlisting">
			
	@RequestMapping("/testRedirect")
	public ModelAndView testRedirect(){
		   RedirectView view = new RedirectView("testMapString.html");
		   return new ModelAndView(view);
	}
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp239"></a>6.1.6.4. ArrayList</h4></div></div></div>
			
			<pre class="programlisting">
			
	@RequestMapping(value = "testList")
	public ModelAndView testList() {
		ModelAndView mav = new ModelAndView();
		mav.setViewName("/test/list");

		// List
		List&lt;String&gt; list = new ArrayList&lt;String&gt;();
		list.add("java");
		list.add("c++");
		list.add("oracle");
		mav.addObject("bookList", list);

		return mav;
	}
			
			</pre>
			<pre class="programlisting">
			
&lt;%@ page language="java" contentType="text/html; charset=ISO-8859-1"
	pageEncoding="ISO-8859-1"%&gt;
&lt;%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"&gt;
&lt;title&gt;Insert title here&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
	${bookList}
	&lt;br&gt;

	&lt;c:forEach items="${bookList}" var="node"&gt;
		&lt;c:out value="${node}"&gt;&lt;/c:out&gt;&lt;br&gt;
	&lt;/c:forEach&gt;

&lt;/body&gt;
&lt;/html&gt;
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp240"></a>6.1.6.5. HashMap</h4></div></div></div>
			
			<pre class="programlisting">
			
	@RequestMapping("/testMap")
	public ModelAndView testMap() {
		ModelAndView mav = new ModelAndView();
		mav.setViewName("test/map"); // 返回的文件名

		// Map
		Map&lt;String, String&gt; map = new HashMap&lt;String, String&gt;();
		map.put("Java", "http://www.netkiller.cn/java");
		map.put("PHP", "http://www.netkiller.cn/php");
		map.put("Home", "http://www.netkiller.cn");
		mav.addObject("channel", map);

		return mav;
	}
			
			</pre>
			<pre class="programlisting">
			
&lt;%@ page language="java" contentType="text/html; charset=utf-8"
    pageEncoding="utf-8"%&gt;
&lt;%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"&gt;
&lt;title&gt;Insert title here&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
	&lt;c:forEach items="${channel}" var="node"&gt;
		&lt;a href="&lt;c:out value="${node.value}"&gt;&lt;/c:out&gt;"&gt;&lt;c:out value="${node.key}"&gt;&lt;/c:out&gt;&lt;/a&gt;
        &lt;br/&gt;
	&lt;/c:forEach&gt;
&lt;/body&gt;
&lt;/html&gt;
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp241"></a>6.1.6.6. 传递对象</h4></div></div></div>
			
			<pre class="programlisting">
			
	@RequestMapping("/testObject")
	public ModelAndView testObject() {
		ModelMap model = new ModelMap();

		User user = new User("neo", "passw0rd");
		model.addAttribute("user", user);
		return new ModelAndView("test/object", model);

	}
			
			</pre>
			<pre class="programlisting">
			
package cn.netkiller;

public class User {
	public String username;
	public String password;
	public User(String username, String password){
		this.username = username;
		this.password = password;
	}
	public String getUsername(){
		return this.username;
	}
	public String getPassword(){
		return this.password;
	}
}
			
			</pre>
			<pre class="programlisting">
			
&lt;%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%&gt;
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"&gt;
&lt;title&gt;Insert title here&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
Username: ${user.username}&lt;br&gt;
Password: ${user.password}&lt;br&gt;
&lt;/body&gt;
&lt;/html&gt;
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp242"></a>6.1.6.7. </h4></div></div></div>
			
			<pre class="programlisting">
			
			
			</pre>
		</div>
	</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="@Scheduled"></a>6.1.7. @Scheduled</h3></div></div></div>
		
		<p>计划任务</p>
		<pre class="screen">
		
@Component
@EnableScheduling
public class MyTask {

    @Scheduled(cron="*/3 * * * * *")
    public void myTaskMethod(){
        //do something
    }
}		
		
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="@CrossOrigin"></a>6.1.8. @CrossOrigin</h3></div></div></div>
		
		<pre class="screen">
	@CrossOrigin(origins = "http://localhost:9000")
    @GetMapping("/greeting")
    public Greeting greeting(@RequestParam(required=false, defaultValue="World") String name) {
        System.out.println("==== in greeting ====");
        return new Greeting(counter.incrementAndGet(), String.format(template, name));
    }
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="@SessionAttributes"></a>6.1.9. @SessionAttributes</h3></div></div></div>
		
		<pre class="programlisting">
		
@Controller
@SessionAttributes("myRequestObject")
public class MyController {
  ...
}
		
		</pre>
	</div>
	<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="http"></a>6.1.10. HttpServletRequest / HttpServletResponse </h3></div></div></div>
		
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp243"></a>6.1.10.1. 用于方法参数</h4></div></div></div>
					
			<p>HttpServletResponse 实例</p>
			<pre class="programlisting">
			
package cn.netkiller.api.rest;

import com.google.zxing.BarcodeFormat;
import com.google.zxing.EncodeHintType;
import com.google.zxing.MultiFormatWriter;
import com.google.zxing.WriterException;
import com.google.zxing.common.BitMatrix;
import api.util.MatrixToImageWriter;
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.servlet.ModelAndView;

import javax.servlet.ServletOutputStream;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;
import java.util.Hashtable;

@Controller
@RequestMapping("/public/QRCode")
public class QRCodeController {
    private static final Logger log = LoggerFactory.getLogger(QRCodeController.class);
	
    @RequestMapping("/create/{code}" )
    @ResponseBody
    public void create(@PathVariable String code, HttpServletResponse httpServletResponse) throws WriterException, IOException {
        log.info(code);
        if (code != null &amp;&amp; !"".equals(code)){
            ServletOutputStream stream = null;
            try {
                String text = code; 	// 二维码内容
                int width = 300; 		// 二维码图片宽度
                int height = 300; 		// 二维码图片高度
                String format = "gif";	// 二维码的图片格式

                Hashtable&lt;EncodeHintType, String&gt; hints = new Hashtable&lt;EncodeHintType, String&gt;();
                hints.put(EncodeHintType.CHARACTER_SET, "utf-8");   // 内容所使用字符集编码

                BitMatrix bitMatrix = new MultiFormatWriter().encode(text, BarcodeFormat.QR_CODE, width, height, hints);
                // 生成二维码
                stream = httpServletResponse.getOutputStream();
                MatrixToImageWriter.writeToStream(bitMatrix, format, stream);

            }catch (WriterException e) {
                e.printStackTrace();
            } finally {
                if (stream != null) {
                    stream.flush();
                    stream.close();
                }
            }
        }
    }

    @RequestMapping("show")
    @ResponseBody
    public ModelAndView show(){

        return new ModelAndView("/qrcode/qrcode");
    }
}		
			
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp244"></a>6.1.10.2. 注入方式</h4></div></div></div>
			
			<pre class="programlisting">
			

			
			</pre>
		</div>
	</div>
</div>
	
	

	
	
</div><div xmlns="" id="disqus_thread"></div><script xmlns="">

var disqus_config = function () {
this.page.url = "http://www.netkiller.cn";  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = 'netkiller'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//netkiller.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script><noscript xmlns="">Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><br xmlns="" /><script xmlns="" type="text/javascript" id="clustrmaps" src="//cdn.clustrmaps.com/map_v2.js?u=r5HG&amp;d=9mi5r_kkDC8uxG8HuY3p4-2qgeeVypAK9vMD-2P6BYM"></script><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="../boot/faq.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="../index.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="RestController.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">5.34. FAQ </td><td width="20%" align="center"><a accesskey="h" href="../../index.html">起始页</a></td><td width="40%" align="right" valign="top"> 6.2. @RestController</td></tr></table></div><script xmlns="">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-11694057-1', 'auto');
  ga('send', 'pageview');

</script><script xmlns="" async="async">
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?93967759a51cda79e49bf4e34d0b0f2c";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script xmlns="" async="async">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script><script xmlns="" type="text/javascript" src="/js/q.js" async="async"></script></body></html>