<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>5.3. application.properties</title><link rel="stylesheet" type="text/css" href="../..//docbook.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.79.1" /><link rel="home" href="../../index.html" title="Netkiller Java 手札" /><link rel="up" href="index.html" title="第 5 章 Spring Boot" /><link rel="prev" href="maven.html" title="5.2. 运行" /><link rel="next" href="SpringApplication.html" title="5.4. SpringApplication" /></head><body><a xmlns="" href="//www.netkiller.cn/">Home</a> |
		<a xmlns="" href="//netkiller.github.io/">简体中文</a> |
	    <a xmlns="" href="http://netkiller.sourceforge.net/">繁体中文</a> |
	    <a xmlns="" href="/journal/index.html">杂文</a> |
	    <a xmlns="" href="//www.netkiller.cn/home/donations.html">打赏(Donations)</a> |
	    <a xmlns="" href="http://netkiller-github-com.iteye.com/">ITEYE 博客</a> |
	    <a xmlns="" href="http://my.oschina.net/neochen/">OSChina 博客</a> |
	    <a xmlns="" href="https://www.facebook.com/bg7nyt">Facebook</a> |
	    <a xmlns="" href="http://cn.linkedin.com/in/netkiller/">Linkedin</a> |
	    <a xmlns="" href="https://zhuanlan.zhihu.com/netkiller">知乎专栏</a> |
	    <a xmlns="" href="/search.html">Search</a> |
		<a xmlns="" href="mailto:netkiller@msn.com">Email</a><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">5.3. application.properties</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="maven.html">上一页</a> </td><th width="60%" align="center">第 5 章 Spring Boot</th><td width="20%" align="right"> <a accesskey="n" href="SpringApplication.html">下一页</a></td></tr></table><hr /></div><table xmlns=""><tr><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=watch&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;repo=netkiller.github.io&amp;type=fork&amp;count=true&amp;size=large" height="30" width="170" frameborder="0" scrolling="0" style="width:170px; height: 30px;" allowTransparency="true"></iframe></td><td><iframe src="//ghbtns.com/github-btn.html?user=netkiller&amp;type=follow&amp;count=true&amp;size=large" height="30" width="240" frameborder="0" scrolling="0" style="width:240px; height: 30px;" allowTransparency="true"></iframe></td></tr></table><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="application.properties"></a>5.3. application.properties</h2></div></div></div>
		
		<p>配置资源文件位置，默认application.properties是放在jar包中的，通过spring.config.location可以制定外部配置文件，这样更便于运维。</p>
		<pre class="screen">
java -jar demo.jar --spring.config.location=/opt/config/application.properties
		</pre>
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="spring.pid"></a>5.3.1. PID FILE</h3></div></div></div>
			
			<pre class="screen">
spring.pid.fail-on-write-error= # Fail if ApplicationPidFileWriter is used but it cannot write the PID file.
spring.pid.file= # Location of the PID file to write (if ApplicationPidFileWriter is used).
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="tomcat"></a>5.3.2. 内嵌 tomcat server</h3></div></div></div>
			
			<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="server.tomcat.basedir"></a>5.3.2.1. server.tomcat.basedir</h4></div></div></div>
				
				<p>设置 Tomcat 工作目录，默认 /tmp/tomcat-docbase.7057591687859485145.7000 通过下面配置修改</p>
				<pre class="screen">
server.tomcat.basedir=/tmp/your_project
				</pre>
			</div>			
			<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="server"></a>5.3.2.2. server</h4></div></div></div>
				
				<pre class="screen">
server.port=8080 	# 监听端口
server.address= 	# 绑定的地址
server.context-path= #默认为/
				</pre>
				<p>连接数配置</p>
				<pre class="screen">
server.tomcat.max-threads=2048 # 最大线程数
				</pre>
			</div>
			<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="access.log"></a>5.3.2.3. tomcat</h4></div></div></div>
				
				<p>如果前端有 nginx 代理这个配置可以禁用</p>
				<pre class="screen">
server.tomcat.accesslog.enabled=true
server.tomcat.accesslog.directory=/tmp/logs
server.tomcat.accesslog.pattern=common
server.tomcat.accesslog.prefix=www.netkiller.cn.access
server.tomcat.accesslog.suffix=.log
				</pre>
			</div>
			<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="logging"></a>5.3.2.4. logging</h4></div></div></div>
				
				<pre class="screen">
logging.path=/tmp # 日志目录默认为 /tmp
logging.file=your.log # 日志文件名称，默认为spring.log
				</pre>
				<pre class="screen">
java -jar spring-boot-app.jar --logging.file=/tmp/spring-boot-app.log				
				</pre>
			</div>
			<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="charset"></a>5.3.2.5. charset</h4></div></div></div>
				
				<p>Spring boot 默认并非UTF-8 所以下面配置必设，否则将会出现</p>
				<pre class="screen">
spring.messages.encoding=UTF-8
server.tomcat.uri-encoding=UTF-8
spring.http.encoding.charset=UTF-8
spring.http.encoding.enabled=true
spring.http.encoding.force=true
				</pre>
			</div>
			<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="session"></a>5.3.2.6. Session 配置</h4></div></div></div>
				
				<pre class="screen">
server.session.persistent		重启时是否持久化session，默认false
server.session.timeout			session的超时时间
server.session.tracking-modes	设定Session的追踪模式(cookie, url, ssl).
server.session.timeout=1800 		#session有效时长
				</pre>
			</div>
			<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="cookie"></a>5.3.2.7. cookie</h4></div></div></div>
				
				<pre class="screen">
server.session.cookie.comment	指定session cookie的comment
server.session.cookie.domain		指定session cookie的domain
server.session.cookie.http-only 	否开启HttpOnly.
server.session.cookie.max-age 	设定session cookie的最大age.
server.session.cookie.name 		设定Session cookie 的名称.
server.session.cookie.path 		设定session cookie的路径.
server.session.cookie.secure 	设定session cookie的“Secure” flag.
				</pre>
				<p>案例</p>
				<pre class="screen">
server.session.cookie.name=PHPSESSID
server.session.cookie.domain=.example.com
server.session.cookie.http-only=true
server.session.cookie.path=/
				</pre>
			</div>
			<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="error"></a>5.3.2.8. error 路径</h4></div></div></div>
				
				<pre class="screen">
server.error.path=/error				
				</pre>
			</div>
			<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="compression"></a>5.3.2.9. 压缩传输</h4></div></div></div>
				
				<pre class="screen">
server.compression.enabled=true			#是否开启压缩，默认为false.
server.compression.excluded-user-agents	#指定不压缩的user-agent，多个以逗号分隔，默认值为:text/html,text/xml,text/plain,text/css
server.compression.mime-types			#指定要压缩的MIME type，多个以逗号分隔.
server.compression.min-response-size	#执行压缩的阈值，默认为2048

server.compression.enabled=true
server.compression.mime-types=application/json,application/xml,text/html,text/xml,text/plain,text/css,application/javascript
server.compression.min-response-size=1024
				</pre>
			</div>
			<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="idp99"></a>5.3.2.10. server.servlet.context-path</h4></div></div></div>
				
				<pre class="screen">
server.servlet.context-path=/your
				</pre>
			</div>
			<div class="section"><div class="titlepage"><div><div><h4 class="title"><a id="ssl"></a>5.3.2.11. ssl</h4></div></div></div>
				
				<pre class="screen">
server.ssl.ciphers			是否支持SSL ciphers.
server.ssl.client-auth		设定client authentication是wanted 还是 needed.
server.ssl.enabled			是否开启ssl，默认: true
server.ssl.key-alias			设定key store中key的别名.
server.ssl.key-password		访问key store中key的密码.
server.ssl.key-store			设定持有SSL certificate的key store的路径，通常是一个.jks文件.
server.ssl.key-store-password设定访问key store的密码.
server.ssl.key-store-provider设定key store的提供者.
server.ssl.key-store-type	设定key store的类型.
server.ssl.protocol			使用的SSL协议，默认: TLS
server.ssl.trust-store		持有SSL certificates的Trust store.
server.ssl.trust-store-password访问trust store的密码.
server.ssl.trust-store-provider设定trust store的提供者.
server.ssl.trust-store-type	指定trust store的类型.
				</pre>
				<p>生成证书</p>
				<p>server.ssl.* #ssl相关配置</p>
				<pre class="screen">
keytool -genkey -alias springboot -keyalg RSA -keystore /www/ssl/spring
设置密码 123456			
				</pre>
				<p>配置 application.properties</p>
				<pre class="screen">
server.ssl.enabled 启动tomcat ssl配置
server.ssl.keyAlias 别名
server.ssl.keyPassword 密码
server.ssl.keyStore 位置			
				</pre>
				<pre class="screen">
server.port=8443
server.ssl.enabled=true
server.ssl.keyAlias=springboot
server.ssl.keyPassword=123456
server.ssl.keyStore=/www/ssl/spring
				</pre>
			</div>
		</div>
		
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="json"></a>5.3.3. JSON</h3></div></div></div>
			
			<pre class="screen">
# Pretty-print JSON responses
spring.jackson.serialization.indent_output=true
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="mail"></a>5.3.4. SMTP 相关配置</h3></div></div></div>
			
			<pre class="screen">
spring.mail.host=smtp.netkiller.cn
#spring.mail.username=
#spring.mail.password=
#spring.mail.properties.mail.smtp.auth=true
#spring.mail.properties.mail.smtp.starttls.enable=true
#spring.mail.properties.mail.smtp.starttls.required=true		
mail.smtp.debug=true
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="redis"></a>5.3.5. Redis</h3></div></div></div>
			
			<pre class="screen">
# REDIS (RedisProperties)
# Redis数据库索引（默认为0）
spring.redis.database=0
# Redis服务器地址
spring.redis.host=localhost
# Redis服务器连接端口
spring.redis.port=6379
# Redis服务器连接密码（默认为空）
spring.redis.password=
# 连接池最大连接数（使用负值表示没有限制）
spring.redis.pool.max-active=8
# 连接池最大阻塞等待时间（使用负值表示没有限制）
spring.redis.pool.max-wait=-1
# 连接池中的最大空闲连接
spring.redis.pool.max-idle=8
# 连接池中的最小空闲连接
spring.redis.pool.min-idle=0
# 连接超时时间（毫秒）
spring.redis.timeout=0
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="mongodb"></a>5.3.6. MongoDB</h3></div></div></div>
			
			<p>格式：mongodb://用户名:密码@主机地址/数据库</p>
			<pre class="screen">
spring.data.mongodb.uri=mongodb://user:passw0rd@mdb.netkiller.cn/test
spring.data.mongodb.repositories.enabled=true
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="mysql"></a>5.3.7. MySQL</h3></div></div></div>
			
			<pre class="screen">
spring.datasource.driver-class-name=com.mysql.jdbc.Driver
spring.datasource.url=jdbc:mysql://主机地址:端口号/数据库
spring.datasource.username=用户名
spring.datasource.password=密码
spring.jpa.database=MYSQL	# 启用JPA支持	
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="oracle"></a>5.3.8. Oracle</h3></div></div></div>
			
			<pre class="screen">
spring.datasource.driver-class-name=oracle.jdbc.OracleDriver
spring.datasource.url=jdbc:oracle:thin:@//odb.netkiller.cn:1521/orcl
spring.datasource.username=orcl
spring.datasource.password=passw0rd
spring.datasource.connection-test-query="SELECT 1 FROM DUAL"
spring.jpa.database-platform=org.hibernate.dialect.Oracle10gDialect

spring.jpa.show-sql=true
#spring.jpa.hibernate.ddl-auto=none
#spring.jpa.hibernate.ddl-auto=create-drop
spring.datasource.max-active=50
spring.datasource.initial-size=5
spring.datasource.max-idle=10
spring.datasource.min-idle=5
spring.datasource.test-while-idle=true
spring.datasource.test-on-borrow=false
spring.datasource.validation-query=SELECT 1 FROM DUAL
spring.datasource.time-between-eviction-runs-millis=5000
spring.datasource.min-evictable-idle-time-millis=60000
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="default_schema"></a>5.3.9. default_schema</h3></div></div></div>
			
			<pre class="screen">
spring.jpa.properties.hibernate.default_schema=schema
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="velocity"></a>5.3.10. velocity</h3></div></div></div>
			
			<pre class="screen">
spring.velocity.resourceLoaderPath=classpath:/templates/
spring.velocity.prefix=
spring.velocity.suffix=.vm
spring.velocity.cache=false
spring.velocity.check-template-location=true
spring.velocity.content-type=text/html
spring.velocity.charset=UTF-8
spring.velocity.properties.input.encoding=UTF-8
spring.velocity.properties.output.encoding=UTF-8			
			</pre>
			<p>禁用 velocity 模板引擎</p>
			<pre class="screen">
spring.velocity.enabled=false
spring.velocity.check-template-location=false
			</pre>
		</div>
		<div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="idp100"></a>5.3.11. </h3></div></div></div>
			
			<pre class="screen">
security.user.name=user
security.user.password=password
security.user.role=USER
			</pre>
			<p>Web 安全</p>
			<pre class="screen">
# X-Frame-Options: DENY
security.headers.frame=false		

security.headers.cache
security.headers.content-type
security.headers.hsts
security.headers.xss
			</pre>
			<p> 参考 https://github.com/spring-projects/spring-boot/blob/master/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/security/SecurityProperties.java#L171</p>
		</div>
	</div><div xmlns="" id="disqus_thread"></div><script xmlns="">

var disqus_config = function () {
this.page.url = "http://www.netkiller.cn";  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = 'netkiller'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//netkiller.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script><noscript xmlns="">Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><br xmlns="" /><script xmlns="" type="text/javascript" id="clustrmaps" src="//cdn.clustrmaps.com/map_v2.js?u=r5HG&amp;d=9mi5r_kkDC8uxG8HuY3p4-2qgeeVypAK9vMD-2P6BYM"></script><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="maven.html">上一页</a> </td><td width="20%" align="center"><a accesskey="u" href="index.html">上一级</a></td><td width="40%" align="right"> <a accesskey="n" href="SpringApplication.html">下一页</a></td></tr><tr><td width="40%" align="left" valign="top">5.2. 运行 </td><td width="20%" align="center"><a accesskey="h" href="../../index.html">起始页</a></td><td width="40%" align="right" valign="top"> 5.4. SpringApplication</td></tr></table></div><script xmlns="">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-11694057-1', 'auto');
  ga('send', 'pageview');

</script><script xmlns="" async="async">
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?93967759a51cda79e49bf4e34d0b0f2c";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script xmlns="" async="async">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script><script xmlns="" type="text/javascript" src="/js/q.js" async="async"></script></body></html>